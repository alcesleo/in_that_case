#!/usr/bin/env ruby
require "rubygems"
require "bundler/setup"
require "docopt"
require "in_that_case"
require "in_that_case/cli"

OPTION_ALIGN_WIDTH = 15
CLI = InThatCase::CLI.new(InThatCase::CONVENTIONS, OPTION_ALIGN_WIDTH)

doc = <<DOC
In That Case

Usage:
  #{__FILE__} #{CLI.convention_option_list} (<input> | -)
  #{__FILE__} -h | --help

Options:
#{CLI.option_documentation}
DOC

begin
  args  = Docopt::docopt(doc)
  input = args.fetch("<input>")
  input = $stdin.gets.chomp if input == "-"

  puts InThatCase.convert(input, CLI.to_convention(args))
rescue Docopt::Exit, InThatCase::InThatCaseError => e
  warn e.message
  exit 1
end
